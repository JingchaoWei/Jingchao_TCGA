exp <- read.delim(unz("data_Xena/HiSeqV2.gz", filename = "HiSeqV2"),row.names = 1, check.names = F )
exp <- read.table("data_Xena/HiSeqV2.gz"row.names = 1, check.names = F )
exp <- read.table("data_Xena/HiSeqV2.gz",row.names = 1, check.names = F )
head(exp,)
d
colnames(exp)
phe <- read.delim("data/PRAD_clinicalMatrix/PRAD_clinicalMatrix",check.names = F)
phe <- read.delim("data_Xena/PRAD_clinicalMatrix/PRAD_clinicalMatrix",check.names = F)
exp_t <- as.data.frame(t(exp))
rownames(exp_t)
exp <- read.table("data_Xena/HiSeqV2.gz",row.names = 1, col.names = 1,check.names = F )
exp_t$sampleID <- rownames(exp_t)
exp_t$sample
exp_t[1:9,1:9]
phe <- read.table("data_Xena/PRAD_clinicalMatrix/PRAD_clinicalMatrix",check.names = F)
phe <- read.table("data_Xena/PRAD_clinicalMatrix/PRAD_clinicalMatrix",check.names = F)
phe <- read.delim2("data_Xena/PRAD_clinicalMatrix/PRAD_clinicalMatrix",check.names = F)
View(phe)
exp <- read.delim2("data_Xena/HiSeqV2.gz",row.names = 1, check.names = F )
exp[1:9,1:9]
View(phe)
exp_t <- as.data.frame(t(exp))
exp_t[1:9,1:9]
exp_t$sampleID <- rownames(exp_t)
merge <- merge(phe,exp_t,by="sampleID",all=F)
merge[1:9,1:9]
save(exp,phe,merge,file = "PCa_TCGA.Rdata")
load("PCa_TCGA.Rdata")
write.table(merge,file = "combined_TCGA_data.txt",quote = F,sep = "\t",row.names = F,col.names = T)
if (!requireNamespace("BiocManager"))
install.packages("BiocManager")
BiocManager::install("RTCGAToolbox")
library(RTCGAToolbox)
debug()
getFirehoseDatasets()
library(RTCGAToolbox)
getFirehoseDatasets()
stddata <- getFirehoseRunningDates()
stddata
valid_aliases <- getFirehoseDatasets()
stddata <- getFirehoseRunningDates(last = T)
source('~/GitHub/Jingchao_TCGA_PRAD/RTCGAToolbox.R', echo=TRUE)
stddata
gisticDate <- getFirehoseAnalyzeDates()
gisticDate
valid_aliases
stddata
getFirehoseRunningDates
stddata <- getFirehoseRunningDates()
stddata
gisticDate
PRAD_data <- getFirehoseData(dataset="PRAD", runDate="20160128",
clinical=TRUE, Mutation=TRUE,
RNASeq2GeneNorm = T)
PRAD_data <- getFirehoseData(dataset="PRAD", runDate="20160128",
clinical=TRUE, Mutation=TRUE,
RNASeq2GeneNorm = T)
valid_aliases <- getFirehoseDatasets()
valid_aliases
stddata <- getFirehoseRunningDates()
stddata
# Wed Nov 07 11:21:03 2018 ------------------------------
gisticDate <- getFirehoseAnalyzeDates()
gisticDate
PRAD_data <- getFirehoseData(dataset="PRAD", runDate="20160128",
clinical=TRUE, RNASeq2GeneNorm = T)
PRAD_data <- getFirehoseData(dataset="PRAD", runDate="20160128",
clinical=TRUE, RNASeq2GeneNorm = T,Mutation = T)
data(RTCGASample)
RTCGASample
str(RTCGASample)
PRAD_data <- getFirehoseData(dataset="PRAD", runDate="20160128",
clinical=TRUE, RNASeq2GeneNorm = T,Mutation = T)
getwd()
ls -1
ls
ls()
dir()
valid_aliases
stddate <- getFirehoseRunningDates()
stddate
PRAD_data <- getFirehoseData(dataset="PRAD", runDate="20151101",forceDownload = F,
clinical=TRUE, RNASeq2GeneNorm = T,Mutation = T)
RTCGASample
getData(RTCGASample, "RNASeqGene")
p
f
diffGeneExprs <- getDiffExpressedGenes(dataObject=RTCGASample, DrawPlots=TRUE,
adj.method="BH", adj.pval=0.05, raw.pval=0.05, logFC=2, hmTopUpN=10,
hmTopDownN=100)
library(RTCGAToolbox)
valid_aliases <- getFirehoseDatasets()
valid_aliases
stddate <- getFirehoseRunningDates()
stddate
gisticDate <- getFirehoseAnalyzeDates()
gisticDate
PRAD_data <- getFirehoseData(dataset="PRAD", runDate="20151101",forceDownload = F,
clinical=TRUE, RNASeq2GeneNorm = T,Mutation = T)
data(RTCGASample)
RTCGASample
getData(RTCGASample, "RNASeqGene")
diffGeneExprs
diffGeneExprs
diffGeneExprs <- getDiffExpressedGenes(dataObject=RTCGASample, DrawPlots=TRUE,
adj.method="BH", adj.pval=0.05, raw.pval=0.05, logFC=2, hmTopUpN=10,
hmTopDownN=100)
diffGeneExprs
View(diffGeneExprs)
par(mfrow=c(2,2))
diffGeneExprs <- getDiffExpressedGenes(dataObject=RTCGASample, DrawPlots=TRUE,
adj.method="BH", adj.pval=0.05, raw.pval=0.05, logFC=2, hmTopUpN=10,
hmTopDownN=100)
showResults(diffGeneExprs[[1]])
toptableOut <- showResults(diffGeneExprs[[1]])
View(toptableOut)
corrGECN <- getCNGECorrelation(dataObject=RTCGASample, adj.method="BH",
adj.pval=0.9, raw.pval=0.05)
corrGECN
showResults(corrGECN[[1]])
showResults(corrGECN[[1]])
corRes <- showResults(corrGECN[[1]])
mutFrq <- getMutationRate(dataObject=RTCGASample)
BRCAdata <- getFirehoseData(dataset="BRCA",
runDate="20140416",gistic2Date="20140115",
RNASeqGene=TRUE,clinical=TRUE,mRNAArray=TRUE,Mutation=TRUE)
head(mutFrq[order(mutFrq[, 2], decreasing=TRUE), ])
clinicData <- getData(RTCGASample,"clinical")
head(clinicData)
clinicData <- clinicData[, 3:5]
clinicData[is.na(clinicData[, 3]), 3] <- clinicData[is.na(clinicData[, 3]), 2]
survData <- data.frame(Samples=rownames(clinicData),
Time=as.numeric(clinicData[, 3]), Censor=as.numeric(clinicData[, 1]))
getSurvival(dataObject=RTCGASample, geneSymbols=c("FCGBP"), sampleTimeCensor=survData)
brcaData <- getFirehoseData (dataset="BRCA", runDate="20140416",
gistic2Date="20140115", clinic=TRUE, RNAseqGene=TRUE, mRNAArray=TRUE,
Mutation=TRUE)
diffGeneExprs <- getDiffExpressedGenes(dataObject=brcaData,DrawPlots=TRUE,
adj.method="BH", adj.pval=0.05, raw.pval=0.05, logFC=2, hmTopUpN=100,
hmTopDownN=100)
if (!requireNamespace("BiocManager"))
install.packages("BiocManager")
BiocManager::install("RTCGAToolbox")
brcaData <- getFirehoseData (dataset="BRCA", runDate="20140416",
gistic2Date="20140115", clinic=TRUE, RNAseqGene=TRUE, mRNAArray=TRUE,
Mutation=TRUE)
